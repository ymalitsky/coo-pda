#+OPTIONS: toc:nil

#+TITLE: Basis pursuit
* Performance of the primal-dual, block-coordinate and coordinate algorithms. Experiment with a DFT.

This documents contains detailed results for the basis pursuit problem
$$\min ||x||_1 \quad \text{s.t.}\quad Ax=b, $$
where $A \in \mathbb{R}^{m\times n}$, $x\in \mathbb{R}^n$, $b\in\mathbb{R}^m$  

We compare primal-dual algorithm, block-coordinate primal-dual algorithm with batch ~d_block~, and fully coordinate primal-dual algorithm (batch = 1).

For given $m,n$ we generate the matrix $A\in \mathbb{R}^{m\times n}$ as follows: $A = R\Phi$, where $\Phi \in \mathbb{R}^{n\times n}$ is the discrete cosine transform and $R\in \mathbb{R}^{m\times n}$ is the random projection matrix: $Rx$ randomly extracts $m$ coordinate from the given $x$. A sparse vector $x^\dagger\in \mathbb{R}^n$ is constructed by choosing at random $50$ of its entries among first $100$ coordinates independently from the normal distribution $\mathcal N(0,1)$. The rest entries of $x^\dagger$ are set to $0$. Then we generate $b = Ax^\dagger$. The starting point for all algorithms is $x^0=0$.  For all methods we use the same stopping criteria:
\begin{equation*}
||Ax^k-b||_\infty \leq 10^{-6}\quad \text{and}\quad \mathrm{dist}(-A^Ty^k,
\partial_{||\cdot||_1}(x^k))_\infty\leq 10^{-6}.
\end{equation*}
This is depicted in ~p_gap~ and ~f_gap~ in the tables respectively.
~CPU~ and ~elapsed~ measure respectively the CPU time and the wall (elapsed) time of the running algorithms. In fact, we even did not include the time for computing $||A||$ for PDA.
~Energy~ means the objective value at the obtained solution for each method.

All methods were tested with different stepsizes: for PDA we use $\sigma = \frac{1}{2^i ||A||}$, $\tau = \frac{2^i}{||A||}$, for $i=0,\dots, 11$. And for (block-)coordinate we use $\sigma = \frac{1}{2^i n_{\text{block}}}$. However, for the PDA results in paper we always used the best $i$ among all, while for the coordinate versions only a fixed $i=8$ (that was almost always optimal).



* Exper 0,    m=1000,  n=4000, d_block=50, spr=0.05 
** Block-Coo
| i       |  8           |  5           |  6           |  7           |  8           |  9           | 10           | 11           |
| epoch   | 41           | 65           | 54           | 45           | 41           | 41           | 48           | 63           |
| p_gap   |  5.67689e-07 |  8.11107e-07 |  4.35068e-07 |  8.92522e-07 |  5.67689e-07 |  8.59048e-08 |  8.90002e-08 |  6.66786e-08 |
| f_gap   |  5.66431e-07 |  7.13926e-07 |  9.93515e-07 |  4.97429e-07 |  5.66431e-07 |  7.9979e-07  |  1.40767e-07 |  6.77861e-07 |
| cpu     | 23.8867      |  2.32581     |  1.80658     |  1.68071     | 23.8867      |  1.69511     |  2.22381     |  2.43136     |
| elapsed |  8.34886     |  0.618992    |  0.461673    |  0.44618     |  8.34886     |  0.452809    |  0.623194    |  0.653174    |
| energy  |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |
* Exper 0,    m=1000,  n=4000, d_block=50, spr=0.05 
** Coo
| i       |  8           |  4           |  5           |  6           |  7           |  8           |  9           | 10           | 11           |
| epoch   | 27           | 64           | 44           | 33           | 29           | 27           | 28           | 34           | 53           |
| p_gap   |  5.65104e-07 |  3.98071e-07 |  8.43903e-07 |  9.08117e-07 |  4.19479e-07 |  5.65104e-07 |  1.52484e-07 |  2.88185e-08 |  3.07814e-08 |
| f_gap   |  9.16513e-07 |  8.34556e-08 |  2.06049e-07 |  2.80568e-07 |  4.27604e-07 |  9.16513e-07 |  7.39547e-07 |  7.87908e-07 |  5.96385e-07 |
| cpu     |  0.914773    |  2.16997     |  1.52963     |  1.14663     |  1.08687     |  0.914773    |  0.949261    |  1.1484      |  1.72536     |
| elapsed |  0.895559    |  2.09238     |  1.46565     |  1.10069     |  1.03927     |  0.895559    |  0.924333    |  1.13026     |  1.69705     |
| energy  |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |
* Exper 0,    m=1000,  n=4000, d_block=50, spr=0.05 
** PDA
| i       |   2           |   0           |   1           |   2           |   3           |   4           |   5           |   6           |
| epoch   | 303           | 330           | 306           | 303           | 313           | 324           | 331           | 376           |
| p_gap   |   4.27001e-07 |   8.8769e-07  |   9.13188e-07 |   4.27001e-07 |   1.97158e-07 |   1.17819e-07 |   8.9658e-08  |   3.02942e-08 |
| f_gap   |   9.31684e-07 |   6.90364e-07 |   8.32618e-07 |   9.31684e-07 |   7.29652e-07 |   8.1289e-07  |   7.89297e-07 |   9.80951e-07 |
| cpu     |   9.39137     |  10.328       |   9.40755     |   9.39137     |   9.76629     |   9.91843     |  14.0836      |  13.2583      |
| elapsed |   2.49548     |   2.74966     |   2.45746     |   2.49548     |   2.68798     |   2.60076     |   4.90906     |   4.14482     |
| energy  |   7.62043     |   7.62043     |   7.62043     |   7.62043     |   7.62043     |   7.62043     |   7.62043     |   7.62043     |
* Exper 0,    m=1000,  n=4000, d_block=50, spr=0.05 
** Block-Coo
| i       |  8           |   2           |   3           |   4           |  5           |  6           |  7           |  8           |  9           | 10           |
| epoch   | 41           | 294           | 163           | 101           | 65           | 54           | 45           | 41           | 41           | 48           |
| p_gap   |  5.67689e-07 |   4.05175e-07 |   6.08853e-07 |   6.89425e-07 |  8.11107e-07 |  4.35068e-07 |  8.92522e-07 |  5.67689e-07 |  8.59048e-08 |  8.90002e-08 |
| f_gap   |  5.66431e-07 |   5.40974e-08 |   6.64792e-08 |   4.75816e-07 |  7.13926e-07 |  9.93515e-07 |  4.97429e-07 |  5.66431e-07 |  7.9979e-07  |  1.40767e-07 |
| cpu     |  1.48564     |   9.03866     |   5.43047     |   3.10614     |  4.35775     |  1.80268     |  1.48378     |  1.48564     |  1.41832     |  2.33995     |
| elapsed |  0.384196    |   2.34052     |   1.42661     |   0.788742    |  1.31895     |  0.460087    |  0.375131    |  0.384196    |  0.359904    |  0.666734    |
| energy  |  7.62043     |   7.62043     |   7.62043     |   7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |
* Exper 0,    m=1000,  n=4000, d_block=50, spr=0.05 
** Coo
| i       |  8           |   1           |   2           |   3           |  4           |  5           |  6           |  7           |  8           |  9           | 10           |
| epoch   | 27           | 374           | 198           | 109           | 64           | 44           | 33           | 29           | 27           | 28           | 34           |
| p_gap   |  5.65104e-07 |   4.21753e-07 |   4.03827e-07 |   3.92354e-07 |  3.98071e-07 |  8.43903e-07 |  9.08117e-07 |  4.19479e-07 |  5.65104e-07 |  1.52484e-07 |  2.88185e-08 |
| f_gap   |  9.16513e-07 |   6.88874e-09 |   2.51554e-08 |   2.55433e-08 |  8.34556e-08 |  2.06049e-07 |  2.80568e-07 |  4.27604e-07 |  9.16513e-07 |  7.39547e-07 |  7.87908e-07 |
| cpu     |  0.91657     |  11.6939      |   6.25326     |   3.57095     |  2.15035     |  1.48448     |  1.14441     |  1.02556     |  0.91657     |  0.962139    |  1.11096     |
| elapsed |  0.899602    |  11.5384      |   6.1423      |   3.45179     |  2.06384     |  1.41922     |  1.10247     |  0.980831    |  0.899602    |  0.935606    |  1.09094     |
| energy  |  7.62043     |   7.62043     |   7.62043     |   7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |  7.62043     |
* Exper 1,    m=2000,  n=8000, d_block=50, spr=0.05 
** PDA
| i       |   2           |   0           |   1           |   2           |   3           |   4           |   5           |   6           |   7           |
| epoch   | 284           | 322           | 298           | 284           | 286           | 303           | 303           | 305           | 342           |
| p_gap   |   9.0863e-07  |   8.92281e-07 |   9.81536e-07 |   9.0863e-07  |   3.55241e-07 |   1.88348e-07 |   1.14117e-07 |   6.31641e-08 |   1.51442e-08 |
| f_gap   |   9.04274e-07 |   5.12766e-07 |   6.33814e-07 |   9.04274e-07 |   9.10398e-07 |   6.79767e-07 |   8.60702e-07 |   9.04582e-07 |   9.88405e-07 |
| cpu     |  29.6011      |  35.4018      |  32.7554      |  29.6011      |  28.0162      |  33.4176      |  33.6511      |  33.6163      |  37.7819      |
| elapsed |   9.59614     |   9.73139     |   9.18173     |   9.59614     |  10.6242      |   9.24566     |   9.17058     |   9.40437     |  10.4486      |
| energy  |   8.54737     |   8.54737     |   8.54737     |   8.54737     |   8.54737     |   8.54737     |   8.54737     |   8.54737     |   8.54737     |
* Exper 1,    m=2000,  n=8000, d_block=50, spr=0.05 
** Block-Coo
| i       |  9           |   2           |   3           |   4           |  5           |  6           |  7           |  8           |  9           | 10           |
| epoch   | 38           | 373           | 199           | 115           | 74           | 50           | 42           | 40           | 38           | 40           |
| p_gap   |  4.78721e-07 |   3.20761e-07 |   9.83678e-07 |   8.88045e-07 |  7.03728e-07 |  7.87722e-07 |  5.16446e-07 |  6.27702e-07 |  4.78721e-07 |  1.16228e-07 |
| f_gap   |  7.41858e-07 |   1.40962e-08 |   1.26472e-07 |   4.53004e-08 |  1.03821e-07 |  6.89916e-07 |  6.28916e-07 |  8.55003e-07 |  7.41858e-07 |  8.4207e-07  |
| cpu     |  5.36683     |  51.9568      |  87.5665      |  12.9159      |  8.7643      |  6.51552     |  5.06658     |  4.8623      |  5.36683     |  5.54449     |
| elapsed |  1.43857     |  14.5583      |  29.249       |   3.33305     |  2.26284     |  1.71397     |  1.2794      |  1.24066     |  1.43857     |  1.47741     |
| energy  |  8.54737     |   8.54737     |   8.54737     |   8.54737     |  8.54737     |  8.54737     |  8.54737     |  8.54737     |  8.54737     |  8.54737     |
* Exper 1,    m=2000,  n=8000, d_block=50, spr=0.05 
** Coo
| i       |  8           |   2           |   3           |  4           |  5           |  6           |  7           |  8           |  9           | 10           |
| epoch   | 23           | 270           | 146           | 84           | 50           | 35           | 28           | 23           | 23           | 23           |
| p_gap   |  4.61941e-07 |   4.03467e-07 |   6.88159e-07 |  6.96791e-07 |  5.65409e-07 |  9.00993e-07 |  6.76092e-07 |  4.61941e-07 |  2.86477e-07 |  9.44575e-08 |
| f_gap   |  9.85821e-07 |   8.29402e-09 |   1.31866e-08 |  4.83423e-08 |  1.8168e-07  |  3.14384e-07 |  4.23766e-07 |  9.85821e-07 |  7.88371e-07 |  6.4057e-07  |
| cpu     |  2.62474     |  29.1         |  15.12        |  9.28983     |  5.44906     |  3.87223     |  3.25201     |  2.62474     |  2.61964     |  2.62277     |
| elapsed |  2.55208     |  28.8462      |  14.7952      |  9.00466     |  5.27971     |  3.73374     |  3.13303     |  2.55208     |  2.52728     |  2.53414     |
| energy  |  8.54737     |   8.54737     |   8.54737     |  8.54737     |  8.54737     |  8.54737     |  8.54737     |  8.54737     |  8.54737     |  8.54737     |
* Exper 2,    m=4000,  n=16000, d_block=50, spr=0.05 
** PDA
| i       |   3           |   0           |   1           |   2           |   3           |   4           |   5           |   6           |
| epoch   | 286           | 316           | 302           | 292           | 286           | 295           | 294           | 307           |
| p_gap   |   8.39343e-07 |   4.27113e-07 |   4.82155e-07 |   9.64117e-07 |   8.39343e-07 |   7.64577e-07 |   3.97099e-07 |   1.47015e-07 |
| f_gap   |   6.99379e-07 |   8.73537e-07 |   8.86801e-07 |   6.05509e-07 |   6.99379e-07 |   9.90924e-07 |   9.17247e-07 |   8.7053e-07  |
| cpu     | 121.585       | 134.138       | 126.824       | 115.27        | 121.585       | 125.828       | 119.192       | 129.058       |
| elapsed |  34.1958      |  37.3816      |  35.8634      |  35.4983      |  34.1958      |  34.8403      |  35.7634      |  36.632       |
| energy  |   7.12459     |   7.12459     |   7.12459     |   7.12459     |   7.12459     |   7.12459     |   7.12459     |   7.12459     |
* Exper 2,    m=4000,  n=16000, d_block=50, spr=0.05 
** Block-Coo
| i       | 10           |   3           |   4           |  5           |  6           |  7           |  8           |  9           | 10           |
| epoch   | 33           | 221           | 123           | 78           | 54           | 42           | 36           | 35           | 33           |
| p_gap   |  1.53575e-07 |   4.27194e-07 |   7.68539e-07 |  5.90985e-07 |  7.16267e-07 |  7.77032e-07 |  5.5705e-07  |  7.75535e-07 |  1.53575e-07 |
| f_gap   |  2.72497e-07 |   1.98803e-08 |   4.99005e-08 |  2.40748e-07 |  8.91116e-08 |  3.66485e-07 |  5.78343e-07 |  8.49485e-07 |  2.72497e-07 |
| cpu     | 17.2657      |  95.6954      |  55.2353      | 36.1613      | 26.7899      | 20.6567      | 17.8942      | 17.6124      | 17.2657      |
| elapsed |  4.54658     |  24.7875      |  14.3148      |  9.41767     |  7.02242     |  5.36628     |  4.62138     |  4.59101     |  4.54658     |
| energy  |  7.12459     |   7.12459     |   7.12459     |  7.12459     |  7.12459     |  7.12459     |  7.12459     |  7.12459     |  7.12459     |
* Exper 2,    m=4000,  n=16000, d_block=50, spr=0.05 
** Coo
| i       |  9           |   2           |   3           |  4           |  5           |  6           |  7           |  8           |  9           | 10           |
| epoch   | 22           | 302           | 159           | 90           | 53           | 37           | 29           | 24           | 22           | 23           |
| p_gap   |  2.9136e-07  |   6.44435e-07 |   6.77139e-07 |  6.4828e-07  |  5.4165e-07  |  7.18847e-07 |  3.97501e-07 |  8.46231e-07 |  2.9136e-07  |  1.73937e-07 |
| f_gap   |  6.54183e-07 |   1.33066e-08 |   1.13031e-08 |  1.96219e-08 |  6.10034e-08 |  1.7334e-07  |  1.72696e-07 |  8.64039e-07 |  6.54183e-07 |  5.53877e-07 |
| cpu     |  9.15089     | 110.959       |  58.0382      | 34.2398      | 20.7098      | 14.9587      | 12.2783      |  9.69518     |  9.15089     |  9.29665     |
| elapsed |  8.81256     | 109.687       |  57.0582      | 33.2863      | 19.9365      | 14.1226      | 11.7779      |  9.39712     |  8.81256     |  8.96354     |
| energy  |  7.12459     |   7.12459     |   7.12459     |  7.12459     |  7.12459     |  7.12459     |  7.12459     |  7.12459     |  7.12459     |  7.12459     |
